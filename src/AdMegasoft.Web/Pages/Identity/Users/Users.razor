@attribute [Authorize(Roles = Permissions.Users.View)]
@page "/identity/users"

@using AdMegasoft.Web.Shared.Components.Table
@using AdMegasoft.Web.Shared.Components.Text
@using Application.Features.Users.Queries.GetAllPaged
@using global::Shared.Constants.Permission

<MegaTitle Title="Usuarios"></MegaTitle>

<MegaTable ServerData="@ServerReload" T="GetAllPagedUsersResponse" @ref="_table">
    <ToolBar>
        <AuthorizeView Roles=@Permissions.Users.Create>
            <MudButton DisableElevation Variant="Variant.Filled"
                       Color="Color.Primary" StartIcon="@Icons.Material.Filled.Add"
                       IconColor="Color.Surface" OnClick="@(() => AddAsync())">
                CREAR
            </MudButton>
        </AuthorizeView>
    </ToolBar>

    <Header>
        <MudTh><MudTableSortLabel SortLabel="IsActive" T="GetAllPagedUsersResponse">Activo</MudTableSortLabel></MudTh>
        <MudTh><MudTableSortLabel SortLabel="Name" T="GetAllPagedUsersResponse">Nombre</MudTableSortLabel></MudTh>
    </Header>

    <RowTemplate>
        <MudTd>
            <MudIcon Color="@(@context.IsActive ? Color.Success : Color.Error)"
                     Icon="@(@context.IsActive ? @Icons.Material.Filled.CheckCircle : @Icons.Material.Filled.Cancel)" />
        </MudTd>
        <MudTd DataLabel="Name">@context.Name</MudTd>
    </RowTemplate>

    <Actions>
        <MudMenuItem @onclick="@(() => EditAsync(@context.Id))">Editar</MudMenuItem>
    </Actions>
</MegaTable>