@page "/identity/permissions/{RoleId:int}"

@using AdMegasoft.Web.Shared.Components.Table
@using AdMegasoft.Web.Shared.Components.Text
@using Application.Features.Permissions.Queries.GetAllPaged

<MegaTitle title="Administrar permisos"></MegaTitle>

<MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true"
         AlwaysShowScrollButtons="true" @bind-ActivePanelIndex="_tabIndex">
    @foreach (var group in _groups)
    {
        <MudTabPanel Text="@group.Name">
            <MegaTable ServerData="@ServerReload" T="GetAllPagedPermissionsResponse">
                <ToolBar>
                    <MudButton DisableElevation Variant="Variant.Filled" Color="Color.Success"
                           StartIcon="@Icons.Material.Filled.Save" IconColor="Color.Surface">
                        Guardar
                    </MudButton>
                </ToolBar>

                <Header>
                    <MudTh><MudTableSortLabel SortLabel="Name" T="GetAllPagedPermissionsResponse">Permiso</MudTableSortLabel></MudTh>
                    <MudTh><MudTableSortLabel SortLabel="Description" T="GetAllPagedPermissionsResponse">Descripción</MudTableSortLabel></MudTh>
                    <MudTh><MudTableSortLabel SortLabel="State" T="GetAllPagedPermissionsResponse">Estado</MudTableSortLabel></MudTh>
                </Header>

                <RowTemplate>
                    <MudTd DataLabel="Name">@context.Name</MudTd>
                    <MudTd DataLabel="Description">@context.Description</MudTd>
                    <MudTd DataLabel="State">
                        <MudCheckBox CheckedChanged="@((bool assigned) => AssignedChange(context, assigned))" Checked="context.Assigned" Color="Color.Primary"></MudCheckBox>
                    </MudTd>
                </RowTemplate>
            </MegaTable>
        </MudTabPanel>
    }
</MudTabs>
