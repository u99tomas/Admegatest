@layout LoginLayout
@page "/"
@page "/authentication/login"
@using AdMegasoft.Web.Shared.Components.Navigation
@using FluentValidation
@using AdMegasoft.Web.Shared.Layouts

<RedirectToDashboard></RedirectToDashboard>
<MudText Typo="Typo.h6" GutterBottom="true">Iniciar sesión</MudText>

<MudForm Model="@_model" @ref="@_form">

    <MudTextField @bind-Value="@_model.AccountName"
                  Validation="@(_validator.ValidateValue)"
                  For="@(() => _model.AccountName)"
                  Immediate="true"
                  Label="Nombre de la cuenta"
                  Variant="Variant.Outlined"
                  Class="my-6" />

    <MudTextField @bind-Value="@_model.Password"
                  Validation="@(_validator.ValidateValue)"
                  For="@(() => _model.Password)"
                  Immediate="true"
                  Label="Contraseña"
                  Variant="Variant.Outlined"
                  Adornment="Adornment.End"
                  AdornmentIcon="@_passwordInputIcon"
                  OnAdornmentClick="TogglePasswordVisibility"
                  InputType="@_passwordInput" />
</MudForm>

<MudButton Variant="Variant.Filled" Class="mt-4" Color="Color.Primary"
           Size="Size.Large" FullWidth="true" OnClick=@LoginAsync Disabled="_loading">
    @if (_loading)
    {
        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
    }
    else
    {
        <MudText>Iniciar sesión</MudText>
    }
</MudButton>

@if (_userEnteredIsIncorrect)
{
    <MudAlert Severity="MudBlazor.Severity.Warning" Class="mt-8 mud-width-full">El usuario ingresado es incorrecto</MudAlert>
}
